{"totalCount":1,"grade":"D","repositories":[{"url":"https://github.com/betagouv/mondevissansoublis","grade":"D","alerts":[{"number":1,"created_at":"2024-12-10T12:27:22Z","updated_at":"2024-12-10T12:27:24Z","url":"https://api.github.com/repos/betagouv/mon-devis-sans-oublis-backend/code-scanning/alerts/1","html_url":"https://github.com/betagouv/mon-devis-sans-oublis-backend/security/code-scanning/1","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"rb/csrf-protection-disabled","severity":"warning","description":"CSRF protection weakened or disabled","name":"rb/csrf-protection-disabled","tags":["external/cwe/cwe-352","security"],"full_description":"Disabling or weakening CSRF protection may make the application vulnerable to a Cross-Site Request Forgery (CSRF) attack.","help":"# CSRF protection weakened or disabled\nCross-site request forgery (CSRF) is a type of vulnerability in which an attacker is able to force a user to carry out an action that the user did not intend.\n\nThe attacker tricks an authenticated user into submitting a request to the web application. Typically this request will result in a state change on the server, such as changing the user's password. The request can be initiated when the user visits a site controlled by the attacker. If the web application relies only on cookies for authentication, or on other credentials that are automatically included in the request, then this request will appear as legitimate to the server.\n\nA common countermeasure for CSRF is to generate a unique token to be included in the HTML sent from the server to a user. This token can be used as a hidden field to be sent back with requests to the server, where the server can then check that the token is valid and associated with the relevant user session.\n\n\n## Recommendation\nIn many web frameworks, CSRF protection is enabled by default. In these cases, using the default configuration is sufficient to guard against most CSRF attacks.\n\n\n## Example\nThe following example shows a case where CSRF protection is disabled by skipping token verification.\n\n\n```ruby\nclass UsersController < ApplicationController\n  skip_before_action :verify_authenticity_token\nend\n\n```\nVerification can be re-enabled by removing the call to `skip_before_action`.\n\nCare should be taken when using the Rails `protect_from_forgery` method to prevent CSRF. The default behaviour of this method is to null the session when an invalid CSRF token is provided. This may not be sufficient to avoid a CSRF vulnerability - for example if parts of the session are memoized. Calling `protect_from_forgery with: :exception` can help to avoid this by raising an exception on an invalid CSRF token instead.\n\n\n## References\n* Wikipedia: [Cross-site request forgery](https://en.wikipedia.org/wiki/Cross-site_request_forgery)\n* OWASP: [Cross-site request forgery](https://owasp.org/www-community/attacks/csrf)\n* Securing Rails Applications: [Cross-Site Request Forgery (CSRF)](https://guides.rubyonrails.org/security.html#cross-site-request-forgery-csrf)\n* Veracode: [When Rails' protect_from_forgery Fails](https://www.veracode.com/blog/managing-appsec/when-rails-protectfromforgery-fails).\n* Common Weakness Enumeration: [CWE-352](https://cwe.mitre.org/data/definitions/352.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.20.2"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:ruby\",\"language\":\"ruby\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:ruby","state":"open","commit_sha":"94525d1bc30d1e5b5f8c958a4d25f639880132fd","message":{"text":"Potential CSRF vulnerability due to forgery protection being disabled or weakened."},"location":{"path":"app/controllers/quote_checks_controller.rb","start_line":9,"end_line":9,"start_column":3,"end_column":105},"classifications":[]},"instances_url":"https://api.github.com/repos/betagouv/mon-devis-sans-oublis-backend/code-scanning/alerts/1/instances"}]}]}